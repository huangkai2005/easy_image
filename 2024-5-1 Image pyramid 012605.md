# Image pyramid

$$
Image \ pyramid \\
kai \ huang\\
May\ 1,2024
$$

## Backgrond

It is mainly used for image cutting and image compression, presenting a pyramid-shaped structure, and the resolution is increasing from top to bottom

## Composition

### Gaussian pyramid

#### Downsampling method (zoom out):

The image is convoluted with a Gaussian kernel and all even-numbered rows and columns in the original image are removed, resulting in a smaller image

![Last_Run](D:\project.test\Image pyramid\Last_Run.png)

![Last_Run_test00{str}](D:\project.test\Image pyramid\Last_Run_test00{str}.png)

![Last_Run_test00str](D:\project.test\Image pyramid\Last_Run_test00str.png)

#### Upsampling method (zoom out):

1. Enlarge the image by two bits in each direction, and fill the new rows and columns with 0 
2. Use the previously unified kernel (multiplied by 4) to enlarge the image convolution to get an approximation

#### Code

```python
def cv_show(img,str) :
    cv.imshow('name',img)
    cv.waitKey(0)
    cv.imwrite('D:\project.test\Image pyramid/Last_Run_test00str.png',img)
    cv.destroyAllWindows()

img=cv.imread("D:\project.test\Image pyramid/Last_Run.png")
print(img.shape)
#Up
up=cv2.pyrUp(img)
cv_show(up,1)
print(up.shape)
#down
down=cv2.pyrDown(img)
cv_show(down,2)

up2=cv2.pyrDown(up)#Restoring again will lose the information
res=np.vstack((img,up2))
print(up2.shape)
cv_show(res,3)
for x in range(5) :
    up2=cv.pyrUp(up2)
    up2=cv.pyrDown(up2)
    res=np.vstack((img,up2))
    print(up2.shape)
    cv_show(res, 3+x+1)

```

### Laplace Pyramid

#### The backgrond

for looking for Lost information after lost Gaussian blur,so The concept of the pyramid of Laplace was proposed

#### The principle

The down operation of the Gaussian pyramid will lose information, and the up operation will fill in the part of 0 to enter the original lost information, and the remaining value of the convolution kernel after the current operation will be subtracted from the original convolution kernel is the convolution kernel of the lost information

#### Code

```python
img=cv.imread("D:\project.test\Image pyramid/Last_Run.png")
img2=img;
img=cv.pyrDown(img)
img=cv.pyrUp(img)
res=img2-img
cv_show(res,0)
```

## Mathematical principles and image show

### Gaussian pyramid

### Downsampling method (zoom out):

$$
K(3,3)=\left[
\matrix{
1 &2&1\\
2&4&2\\
1&2&1
} 
\right ]\ \  G=\left[
\matrix{
1&1\\
1&1
} 
\right ]
$$

### Upsampling method (zoom out):

$$
K(2,2)=\left[
\matrix{
1&2\\
3&4
} 
\right ] \ \ \ G=\left[
\matrix{
1&0&2&0\\
0&0&0&0\\
3&0&4&0\\
0&0&0&0
} 
\right ]
$$



### Laplace Pyramid

$$
Li=Gi-UP(down(Gi)) 
$$

## Recover high-resolution images

![image-20240501180207316](C:\Users\黄凯\AppData\Roaming\Typora\typora-user-images\image-20240501180207316.png)

![Last_Run_test00str](D:\project.test\Image pyramid\Last_Run_test00str.png)

### The principle

Use the Laplace pyramid to add back the original missing information   

```python
#The Gauss pyramids and Laplace pyramids restore high-resolution images

img=cv.imread("D:\project.test\Image pyramid/Last_Run.png")
#1.Downsampling (Gaussian pyramid composition)
g1=cv.pyrDown(img)
g2=cv.pyrDown(g1)
g3=cv .pyrDown(g2)

#Pyramid of Laplace

l0=img-cv.pyrUp(g1)
l1=g1-cv.pyrUp(g2)
l2=g2-cv.pyrUp(g3)


#psampling recovers high-resolution photographs

g0=l0+cv.pyrUp(g1)
g1=l1+cv.pyrUp(g2)
g2=l2+cv.pyrUp(g3)

cv_show(g0,'High-resolution images001')
cv_show(g1,'High-resolution images002')
cv_show(g2,'High-resolution images003')
```